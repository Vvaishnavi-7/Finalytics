

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login | Finance App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }

    /* === Background Animation === */
    .background {
      position: fixed;
      margin-top: 50px;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: -1; /* behind login card */
    }

    .piggy-container {
      position: relative;
      width: 400px;
      height: 300px;
    }

    .piggy-container img {

      margin-top: 130px;
      width: 80%;
      height: auto;
      display: block;
    }

    .coin {
      position: absolute;
      width: 40px;
      height: 40px;
      background: radial-gradient(circle at 30% 30%, #ffd700, #e6ac00);
      border-radius: 50%;
      border: 2px solid #cc8400;
      box-shadow: inset -3px -3px 6px rgba(0,0,0,0.4),
                  inset 3px 3px 6px rgba(255,255,255,0.4);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 18px;
      font-weight: bold;
      color: #660000;
      font-family: Arial, sans-serif;
      left: 50%;
      transform: translateX(-50%);
      top: -50px;
      opacity: 0;
      animation: drop 3s infinite;
    }

    @keyframes drop {
      0%   { top: -50px; opacity: 0; }
      20%  { opacity: 1; }
      100% { top: 300px; opacity: 1; }
    }

    .coin:nth-child(2) { left: 40%; animation-delay: 1s; }
    .coin:nth-child(3) { left: 60%; animation-delay: 2s; }
    .coin:nth-child(4) { left: 45%; animation-delay: 3s; }
    .coin:nth-child(5) { left: 55%; animation-delay: 4s; }

    /* === Login Card === */
    .card {
      background-color: rgba(255, 255, 255, 0.92);
      z-index: 1;
      position: relative;
    }
    #otpForm, #resetForm { display: none; }
  </style>
</head>
<body>
  <script>
    emailjs.init("YOUR_PUBLIC_KEY"); // Replace with your EmailJS public key
  </script>

  <!-- ðŸ”¹ Coin Animation Background -->
  <div class="background">
    <div class="piggy-container">
      <img src="https://img.pikbest.com/png-images/20250518/transparent-glass-piggy-bank-filled-with-golden-coins_11718039.png!bw700" alt="Glass Piggy Bank">
      <div class="coin">â‚¹</div>
      <div class="coin">â‚¹</div>
      <div class="coin">â‚¹</div>
      <div class="coin">â‚¹</div>
      <div class="coin">â‚¹</div>
    </div>
  </div>

  <!-- ðŸ”¹ Login Form -->
  <div class="container mt-5">
    <div class="card p-4 mx-auto shadow-lg" style="max-width: 400px;">
      <h3 class="text-center mb-3" id="formTitle">Sign In</h3>

      <form id="loginForm" onsubmit="loginUser(event)">
        <input type="email" id="loginEmail" class="form-control mb-3" placeholder="Email" required>
        <input type="password" id="loginPassword" class="form-control mb-3" placeholder="Password" required>
        <button class="btn btn-primary w-100">Login</button>
        <p class="text-center mt-3">
          <a href="#" onclick="showOtpForm()">Forgot Password?</a><br>
          Don't have an account? <a href="register.html">Register</a>
        </p>
      </form>

      <form id="otpForm" onsubmit="sendOtp(event)">
        <input type="email" id="otpEmail" class="form-control mb-3" placeholder="Enter registered email" required>
        <button class="btn btn-warning w-100">Send OTP</button>
        <p class="text-center mt-3">
          <a href="#" onclick="showLoginForm()">Back to Login</a>
        </p>
      </form>

      <form id="resetForm" onsubmit="resetPassword(event)">
        <input type="text" id="enteredOtp" class="form-control mb-2" placeholder="Enter OTP" required>
        <input type="password" id="newPassword" class="form-control mb-3" placeholder="New Password" required>
        <button class="btn btn-success w-100">Reset Password</button>
      </form>
    </div>
  </div>

  <script>
    let generatedOtp = "";
    let userEmail = "";

    function loginUser(event) {
      event.preventDefault();
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;
      const storedEmail = localStorage.getItem("userEmail");
      const storedPassword = localStorage.getItem("userPassword");

      if (email === storedEmail && password === storedPassword) {
        window.location.href = "Entry.html";
      } else {
        alert("Invalid email or password!");
      }
    }

    function showOtpForm() {
      document.getElementById("formTitle").textContent = "Forgot Password";
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("otpForm").style.display = "block";
    }

    function showLoginForm() {
      document.getElementById("formTitle").textContent = "Sign In";
      document.getElementById("otpForm").style.display = "none";
      document.getElementById("resetForm").style.display = "none";
      document.getElementById("loginForm").style.display = "block";
    }

    function sendOtp(event) {
      event.preventDefault();
      const email = document.getElementById("otpEmail").value;
      const storedEmail = localStorage.getItem("userEmail");

      if (email !== storedEmail) {
        alert("Email not registered.");
        return;
      }

      userEmail = email;
      generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();

      const templateParams = { to_email: email, otp: generatedOtp };

      emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", templateParams)
        .then(() => {
          alert("OTP sent to your email.");
          document.getElementById("otpForm").style.display = "none";
          document.getElementById("resetForm").style.display = "block";
        })
        .catch(err => {
          alert("Failed to send OTP. Check EmailJS config.");
          console.error(err);
        });
    }

    function resetPassword(event) {
      event.preventDefault();
      const enteredOtp = document.getElementById("enteredOtp").value;
      const newPassword = document.getElementById("newPassword").value;

      if (enteredOtp === generatedOtp) {
        localStorage.setItem("userPassword", newPassword);
        alert("Password reset successfully.");
        showLoginForm();
      } else {
        alert("Invalid OTP!");
      }
    }
  </script>
</body>
</html>

